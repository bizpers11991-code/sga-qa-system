# ============================================================================
# SGA QA System - Environment Configuration
# ============================================================================
# Copy this file to .env.local for local development
# Add these variables to Vercel project settings for production
# 
# Updated: November 2025
# Stack: Microsoft 365 / SharePoint / Azure OpenAI
# ============================================================================

# ============================================================================
# MICROSOFT 365 / AZURE AD (REQUIRED)
# ============================================================================
# Azure AD App Registration credentials
# Get from: Azure Portal > App Registrations > Your App > Overview/Certificates

TENANT_ID=your-azure-tenant-id
CLIENT_ID=your-azure-app-client-id
CLIENT_SECRET=your-azure-app-client-secret

# ============================================================================
# SHAREPOINT (REQUIRED)
# ============================================================================
# Your SharePoint site URL for data storage

SHAREPOINT_SITE_URL=https://sgagroupcomau.sharepoint.com/sites/SGAQualityAssurance

# ============================================================================
# FRONTEND AUTHENTICATION (MSAL)
# ============================================================================
# For user authentication in the React frontend
# The client ID should be the same as above (or a separate SPA app registration)

VITE_MSAL_CLIENT_ID=your-client-id-here
VITE_MSAL_AUTHORITY=https://login.microsoftonline.com/your-tenant-id-here
VITE_MSAL_REDIRECT_URI=http://localhost:5173

# For production, set to your Vercel domain:
# VITE_MSAL_REDIRECT_URI=https://your-app.vercel.app

# ============================================================================
# AI FEATURES - AZURE OPENAI (RECOMMENDED)
# ============================================================================
# Microsoft Azure OpenAI for AI summaries (integrates with M365 Copilot)
# Get from: Azure Portal > Azure OpenAI > Your Resource

AZURE_OPENAI_ENDPOINT=https://your-resource.openai.azure.com
AZURE_OPENAI_API_KEY=your-azure-openai-api-key
AZURE_OPENAI_DEPLOYMENT=gpt-4
AZURE_OPENAI_API_VERSION=2024-02-15-preview

# ============================================================================
# AI FEATURES - GOOGLE GEMINI (FALLBACK)
# ============================================================================
# If not using Azure OpenAI, you can use Google Gemini
# Get from: https://aistudio.google.com/apikey

GOOGLE_API_KEY=your-gemini-api-key
# Legacy alias (some files use this)
API_KEY=your-gemini-api-key

# ============================================================================
# MICROSOFT TEAMS NOTIFICATIONS (OPTIONAL)
# ============================================================================
# Incoming Webhook URLs for Teams channels
# Get from: Teams > Channel > Connectors > Incoming Webhook

TEAMS_WEBHOOK_URL_SUMMARY=https://your-org.webhook.office.com/...
TEAMS_WEBHOOK_URL_QA_PACK=https://your-org.webhook.office.com/...
TEAMS_WEBHOOK_URL_ERROR=https://your-org.webhook.office.com/...
TEAMS_WEBHOOK_URL_MANAGEMENT=https://your-org.webhook.office.com/...
TEAMS_WEBHOOK_URL_BIOSECURITY=https://your-org.webhook.office.com/...
TEAMS_WEBHOOK_URL_INCIDENTS=https://your-org.webhook.office.com/...

# Division-specific channels
TEAMS_WEBHOOK_URL_ASPHALT_JOBS=https://your-org.webhook.office.com/...
TEAMS_WEBHOOK_URL_PROFILING_JOBS=https://your-org.webhook.office.com/...
TEAMS_WEBHOOK_URL_SPRAY_JOBS=https://your-org.webhook.office.com/...
TEAMS_WEBHOOK_URL_ASPHALT_QAPACK=https://your-org.webhook.office.com/...
TEAMS_WEBHOOK_URL_PROFILING_QAPACK=https://your-org.webhook.office.com/...
TEAMS_WEBHOOK_URL_SPRAY_QAPACK=https://your-org.webhook.office.com/...

# ============================================================================
# CRON JOBS (VERCEL)
# ============================================================================
# Secret to authenticate cron job requests

CRON_SECRET=your-random-secret-string

# ============================================================================
# APPLICATION SETTINGS
# ============================================================================

NODE_ENV=development
VITE_APP_NAME=SGA QA Pack
VITE_API_BASE_URL=/api

# ============================================================================
# NOTES
# ============================================================================
# 
# Required for basic operation:
# - TENANT_ID, CLIENT_ID, CLIENT_SECRET (Azure AD)
# - SHAREPOINT_SITE_URL
# - VITE_MSAL_* (Frontend auth)
#
# Required for AI features:
# - Either AZURE_OPENAI_* OR GOOGLE_API_KEY
#
# Optional but recommended:
# - TEAMS_WEBHOOK_* (For notifications)
# - CRON_SECRET (For scheduled tasks)
#
# This system uses SharePoint Lists for data storage and
# SharePoint Document Libraries for file storage.
# No additional databases (Redis, Dataverse) are required.
#
# ============================================================================
